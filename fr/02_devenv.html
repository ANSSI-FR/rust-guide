<!DOCTYPE HTML>
<html lang="fr" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Environnement de développement - Développement sécurisé en Rust</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Recommandations pour le développement d&#x27;applications sécurisées en Rust">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Développement sécurisé en Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="environnement-de-développement"><a class="header" href="#environnement-de-développement">Environnement de développement</a></h1>
<h2 id="rustup"><a class="header" href="#rustup">Rustup</a></h2>
<p><a href="https://github.com/rust-lang/rustup.rs">Rustup</a> est l'installateur des outils de la chaîne de compilation pour Rust.
Entre autres choses, il permet de basculer entre différentes variantes de la
chaîne d'outils (<em>stable</em>, <em>beta</em>, <em>nightly</em>), de gérer l'installation des
composants additionnels et de maintenir le tout à jour.</p>
<blockquote>
<p><strong>Attention</strong></p>
<p>Du point de vue de la sécurité, <code>rustup</code> effectue tous les téléchargements en
HTTPS, mais ne valide pas les signatures des fichiers téléchargés. Les
protections contre les attaques par déclassement, le <em>pinning</em> de certificats
et la validation des signatures sont des travaux actuellement en cours. Pour
les cas les plus sensibles, il peut être préférable d'opter pour une méthode
d'installation alternative comme celles listées dans la section <em>Install</em> du
site officiel du langage Rust.</p>
</blockquote>
<h3 id="Éditions-rust"><a class="header" href="#Éditions-rust">Éditions Rust</a></h3>
<p>Il existe plusieurs variantes du langage Rust, appelées <em>éditions</em>. Le concept
d'éditions a été introduit afin de distinguer la mise en place de nouvelles
fonctionnalités dans le langage, et de rendre ce processus incrémental.
Toutefois, comme mentionné dans le <em><a href="https://doc.rust-lang.org/edition-guide/">Edition Guide</a></em>, cela ne signifie pas que
de nouvelles fonctionnalités et améliorations ne seront incluses que dans la
dernière édition.</p>
<p>Certaines éditions peuvent introduire de nouvelles constructions dans le langage
et de nouveaux mots-clés. Les recommandations concernant ces fonctionnalités
deviennent alors fortement liées à une édition en particulier. Dans le reste de
ce guide, un effort sera réalisé pour mettre en évidence les règles qui ne
s'appliqueraient qu'à certaines éditions de Rust en particulier.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>Aucune édition spécifique n'est recommandée, tant que le développement se
conforme aux recommandations exprimées à propos des fonctionnalités que
l'édition utilisée propose.</p>
</blockquote>
<h3 id="chaînes-doutils-stable-nightly-et-beta"><a class="header" href="#chaînes-doutils-stable-nightly-et-beta">Chaînes d'outils <em>stable</em>, <em>nightly</em> et <em>beta</em></a></h3>
<p>De manière orthogonale aux éditions qui permettent d'opter pour une variante du
langage en termes de fonctionnalités, la chaîne d'outils du langage Rust est
déclinée en trois variantes appelées <em>release channels</em>.</p>
<ul>
<li>La version <em>nightly</em> est produite une fois par jour.</li>
<li>La version <em>nightly</em> est promue en version <em>beta</em> toutes les six semaines.</li>
<li>La version <em>beta</em> est promue en version <em>stable</em> toutes les six semaines.</li>
</ul>
<p>Lors du développement d'un projet, il est important de vérifier non seulement
la version de la chaîne d'outils couramment sélectionnée par défaut, mais aussi
les potentielles surcharges qui peuvent être définies en fonction des
répertoires :</p>
<pre><code class="language-shell">$ pwd
/tmp/foo
$ rustup toolchain list
stable-x86_64-unknown-linux-gnu (default)
beta-x86_64-unknown-linux-gnu
nightly-x86_64-unknown-linux-gnu
$ rustup override list
/tmp/foo                                    nightly-x86_64-unknown-linux-gnu
$
</code></pre>
<!-- -->
<blockquote>
<p><strong>Règle <a id="DENV-STABLE"></a>DENV-STABLE</strong></p>
<p>Le développement d'applications sécurisées doit être mené en utilisant la
chaîne d'outils dans sa version <em>stable</em>, afin de limiter les potentiels
<em>bugs</em> à la compilation, à l'exécution et lors de l'utilisation d'outils
complémentaires.</p>
</blockquote>
<p>Enfin, lorsque l'utilisation d'un outil (par exemple, une sous-commande <code>cargo</code>)
requiert l'installation d'un composant dans une chaîne d'outils non <em>stable</em>,
le basculement de variante doit être effectué de la façon la plus locale
possible (idéalement, uniquement pendant la commande concernée) au lieu
d'explicitement basculer la version courante. Par exemple, pour lancer la
version <em>nightly</em> de la commande <code>rustfmt</code> :</p>
<pre><code class="language-shell">$ rustup toolchain list
stable-x86_64-unknown-linux-gnu (default)
beta-x86_64-unknown-linux-gnu
nightly-x86_64-unknown-linux-gnu
$ rustup run nightly cargo fmt
$ # or
$ cargo +nightly fmt
$
</code></pre>
<h2 id="cargo"><a class="header" href="#cargo">Cargo</a></h2>
<p>Une fois que la chaîne d'outils appropriée a été sélectionnée avec Rustup,
l'outil <a href="https://doc.rust-lang.org/stable/cargo/">Cargo</a> est disponible pour exécuter ces différents outils en
fournissant la commande <code>cargo</code>. Cargo est le gestionnaire de paquetages de Rust.
Il joue plusieurs rôles fondamentaux tout au long d'un développement en Rust. Il
permet notamment de :</p>
<ul>
<li>structurer le projet en fournissant un squelette de projet (<code>cargo new</code>) ;</li>
<li>lancer la compilation du projet (<code>cargo build</code>) ;</li>
<li>lancer la génération de la documentation (<code>cargo doc</code>) ;</li>
<li>lancer les tests (<code>cargo test</code>) et les <em>benchmarks</em> (<code>cargo bench</code>) ;</li>
<li>gérer le téléchargement des dépendances ;</li>
<li>rendre le projet distribuable et le publier sur <a href="https://crates.io">crates.io</a>
(<code>cargo publish</code>) ;</li>
<li>lancer des outils complémentaires tels que ceux décrits ci-après, sous la
forme de sous-commandes.</li>
</ul>
<blockquote>
<p><strong>Attention</strong></p>
<p>Tout comme <code>rustup</code>, <code>cargo</code> effectue tous les téléchargements en HTTPS, mais
ne valide pas l'index du registre. Des discussions sont en cours pour
déterminer le meilleur moyen de protéger et de valider les <em>crates</em>. Pour le
moment, la sécurité de <code>cargo</code> repose sur la bonne sécurité du site web
<a href="https://crates.io">crates.io</a> ainsi que celle du dépôt, hébergé sur GitHub, contenant l'index du
registre de <em>crates</em>. Pour les cas les plus sensibles, il peut être préférable
d'opter pour une méthode d'installation alternative pour les dépendances.</p>
</blockquote>
<p>Cargo propose différentes commandes et options pour adapter le processus de
compilation aux besoins de chaque projet, principalement au travers du fichier
<code>Cargo.toml</code>. Pour une présentation complète, voir le <em><a href="https://doc.rust-lang.org/cargo/index.html">Cargo Book</a></em>.</p>
<p>Certaines de ces options requièrent une attention particulière.</p>
<p>La section <code>[profile.*]</code> permet de configurer la façon dont le compilateur est
invoqué. Par exemple :</p>
<ul>
<li>La variable <code>debug-assertions</code> contrôle l'activation des assertions de
<em>debug</em>.</li>
<li>La variable <code>overflow-checks</code> contrôle l'activation de la vérification des
dépassements d'entiers lors d'opérations arithmétiques.</li>
</ul>
<p>Changer les options par défaut pour ces variables peut entraîner l'apparition de
<em>bugs</em> non détectés, même si le profil de <em>debug</em> qui active normalement les
vérifications (par exemple, les
<a href="./04_language.html#integer-overflows">vérifications de dépassements d'entiers</a>)
est utilisé.</p>
<blockquote>
<p><strong>Règle <a id="DENV-CARGO-OPTS"></a>DENV-CARGO-OPTS</strong></p>
<p>Les variables <code>debug-assertions</code> et <code>overflow-checks</code> ne doivent pas être
modifiées dans les sections de profils de développement (<code>[profile.dev]</code> and
<code>[profile.test]</code>).</p>
</blockquote>
<p>Cargo propose d'autres moyens de configuration afin de modifier son comportement
sur un système donné. Cela peut être très pratique, mais il peut alors aussi
être difficile de connaître et de se souvenir de toutes les options qui sont
effectivement passées à <code>cargo</code>, et en particulier passées ensuite au
compilateur Rust. Finalement, cela peut affecter la robustesse du processus de
compilation et la confiance qu'on lui accorde. Il est préférable de centraliser
les options de compilation dans le fichier de configuration <code>Cargo.toml</code>. Pour
le cas spécifique de la variable d'environnement <code>RUSTC_WRAPPER</code>, utilisée par
exemple pour générer une partie du code ou pour invoquer un outil externe avant
la compilation, il est préférable d'utiliser la fonctionnalité de <em>scripts de
compilation</em> de Cargo.</p>
<blockquote>
<p><strong>Règle <a id="DENV-CARGO-ENVVARS"></a>DENV-CARGO-ENVVARS</strong></p>
<p>Les variables d'environnement <code>RUSTC</code>, <code>RUSTC_WRAPPER</code> et <code>RUSTFLAGS</code> ne
doivent pas être modifiées lorsque Cargo est appelé pour compiler un projet.</p>
</blockquote>
<h3 id="clippy"><a class="header" href="#clippy">Clippy</a></h3>
<p><a href="https://github.com/rust-lang/rust-clippy">Clippy</a> est un outil permettant la vérification de nombreux <em>lints</em> (<em>bugs</em>,
style et lisibilité du code, problèmes de performances, etc.). Depuis la chaîne
d'outils stable en version 1.29, <code>clippy</code> peut être installé dans
l'environnement <code>rustup</code> stable. Il est aussi recommandé d'installer <code>clippy</code> en
tant que composant (<code>rustup component add clippy</code>) dans la chaîne d'outils
stable plutôt que de l'installer comme une dépendance de chaque projet.</p>
<p>L'outil fournit plusieurs catégories de <em>lints</em>, selon le type de problème qu'il
vise à détecter dans le code. Les avertissements doivent être revérifiés par le
développeur avant d'appliquer la réparation suggérée par <code>clippy</code>, en
particulier dans le cas des <em>lints</em> de la catégorie <code>clippy::nursery</code> puisque
ceux-ci sont encore en cours de développement et de mise au point.</p>
<blockquote>
<p><strong>Règle <a id="DENV-LINTER"></a>DENV-LINTER</strong></p>
<p>Un <em>linter</em> comme <code>clippy</code> doit être utilisé régulièrement tout au long du
développement d'une application sécurisée.</p>
</blockquote>
<h3 id="rustfmt"><a class="header" href="#rustfmt">Rustfmt</a></h3>
<p><a href="https://github.com/rust-lang/rustfmt">Rustfmt</a> est un outil offrant la possibilité de formater du code en fonction
de consignes de style (<em>style guidelines</em>). La documentation de l'outil
mentionne certaines limitations parmi lesquelles un support partiel des macros
(déclaration et utilisation). L'option <code>--check</code>, qui affiche les différences
de formatage entre le code actuel et le code proposé, doit être utilisé. À la
suite de cette première utilisation, l'utilisateur doit vérifier les
changements, puis éventuellement les valider en réinvoquant l'outil sans
option.</p>
<p>En résumé :</p>
<pre><code class="language-shell">$ cargo fmt -- --check
$ # review of the changes
$ cargo fmt
</code></pre>
<p>Les règles de convention de style peuvent être personnalisées au besoin dans
le fichier <code>rustfmt.toml</code> ou <code>.rustfmt.toml</code> à la racine du projet. Il sera
utilisé par l'outil en écrasant les préférences par défaut. Par exemple :</p>
<pre><code class="language-toml"># Set the maximum line width to 120
max_width = 120
# Maximum line length for single line if-else expressions
single_line_if_else_max_width = 40
</code></pre>
<p>Pour plus d'informations à propos des règles de convention de style que
<code>rustfmt</code> propose, voir le <a href="https://doc.rust-lang.org/style-guide/index.html"><em>Rust Style Guide</em></a>.</p>
<blockquote>
<p><strong>Règle <a id="DENV-FORMAT"></a>DENV-FORMAT</strong></p>
<p>L'outil de formatage <code>rustfmt</code> peut être utilisé pour assurer le respect de
règles de convention de style (comme décrites dans le fichier <code>rustfmt.toml</code>)
sur une base de code, avec l'option <code>--check</code> ainsi qu'une revue de code
manuelle.</p>
</blockquote>
<h3 id="rustfix"><a class="header" href="#rustfix">Rustfix</a></h3>
<p>Inclus dans la distribution Rust depuis la fin de l'année 2018, <a href="https://github.com/rust-lang-nursery/rustfix">Rustfix</a> est un
outil dédié à la réparation des avertissements de compilation et facilitant la
transition entre éditions.</p>
<pre><code class="language-shell">$ cargo fix
</code></pre>
<p>Pour préparer la transition d'un projet de l'édition Rust 2015 à Rust 2018, il
est possible de lancer la commande suivante :</p>
<pre><code class="language-shell">$ cargo fix --edition
</code></pre>
<p>Rustfix va soit réparer le code afin de le rendre compatible avec Rust 2018,
ou bien afficher un avertissement décrivant le problème. Le problème devra alors
être réparé manuellement. En exécutant la commande (et en réparant
potentiellement les problèmes manuellement) jusqu'à ce qu'elle n'affiche plus
aucun avertissement, il est possible de s'assurer que le code est compatible
tant avec Rust 2015 qu'avec Rust 2018.</p>
<p>Pour basculer définitivement le projet sous Rust 2018 :</p>
<pre><code class="language-shell">$ cargo fix --edition-idioms
</code></pre>
<p>Il est important de noter que l'outil ne fournit que peu de garanties quant
à la correction (<em>soundness</em>) des réparations proposées. Dans une certaine
configuration, certaines réparations (comme celles proposées avec l'option
<code>--edition-idioms</code>) sont connues pour casser la compilation ou pour modifier
la sémantique d'un programme dans certains cas.</p>
<blockquote>
<p><strong>Règle <a id="DENV-AUTOFIX"></a>DENV-AUTOFIX</strong></p>
<p>Dans le cadre du développement d'une application sécurisée, toute réparation
automatique (comme celles appliquées par <code>rustfix</code> par exemple) doit être
vérifiée par le développeur.</p>
</blockquote>
<h3 id="autres"><a class="header" href="#autres">Autres</a></h3>
<p>D'autres outils ou sous-commandes <code>cargo</code> utiles pour renforcer la sécurité
d'un programme existent, par exemple, en recherchant des motifs de code
particuliers. Nous en discutons dans les chapitres suivants en fonction de leurs
portées et de leurs objectifs.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="01_introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="03_libraries.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="01_introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="03_libraries.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
